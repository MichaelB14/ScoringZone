<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Tracker</title>
    <meta name="theme-color" content="#2c5f2d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Golf Tracker">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #2c5f2d, #4a8c4a);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .nav {
            display: flex;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-btn.active {
            background: #2c5f2d;
            color: white;
        }

        .container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .round-form {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #4a8c4a;
        }

        .hole-selector {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .hole-btn {
            padding: 12px 8px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .hole-btn.active {
            background: #2c5f2d;
            color: white;
            border-color: #2c5f2d;
        }

        .hole-btn.completed {
            background: #4a8c4a;
            color: white;
            border-color: #4a8c4a;
        }

        .hole-data-entry {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .hole-data-entry.active {
            display: block;
        }

        .hole-title {
            font-size: 20px;
            font-weight: bold;
            color: #2c5f2d;
            margin-bottom: 20px;
            text-align: center;
        }

        .stat-group {
            margin-bottom: 20px;
        }

        .stat-group h4 {
            color: #2c5f2d;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .toggle-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .toggle-btn {
            padding: 10px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .toggle-btn.active {
            background: #4a8c4a;
            color: white;
            border-color: #4a8c4a;
        }

        .toggle-btn.bad {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .number-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .number-input label {
            flex: 1;
            margin: 0;
        }

        .number-input input {
            width: 80px;
            text-align: center;
        }

        .btn {
            background: linear-gradient(135deg, #2c5f2d, #4a8c4a);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
            margin-top: 20px;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: #6c757d;
            margin-top: 10px;
        }

        .history-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .history-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 14px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
        }

        .trends {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .trend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .trend-item:last-child {
            border-bottom: none;
        }

        .trend-value {
            font-weight: bold;
            color: #2c5f2d;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: #4a8c4a;
            height: 100%;
            transition: width 0.3s;
        }

        .round-summary {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .summary-item {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .summary-number {
            font-size: 24px;
            font-weight: bold;
            color: #2c5f2d;
        }

        .summary-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèåÔ∏è Golf Tracker</h1>
        <p>Track your progress, improve your game</p>
    </div>

    <div class="nav">
        <button class="nav-btn active" onclick="showTab('entry')">New Round</button>
        <button class="nav-btn" onclick="showTab('history')">History</button>
        <button class="nav-btn" onclick="showTab('trends')">Trends</button>
    </div>

    <div class="container">
        <!-- New Round Entry -->
        <div id="entry" class="tab-content active">
            <div class="round-form">
                <h2>New Round Entry</h2>
                
                <div class="form-group">
                    <label>Course Name</label>
                    <input type="text" id="courseName" placeholder="Enter course name">
                </div>

                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="roundDate">
                </div>

                <div class="form-group">
                    <label>Select Hole to Enter Data</label>
                    <div class="hole-selector">
                        <button class="hole-btn" onclick="selectHole(1)">1</button>
                        <button class="hole-btn" onclick="selectHole(2)">2</button>
                        <button class="hole-btn" onclick="selectHole(3)">3</button>
                        <button class="hole-btn" onclick="selectHole(4)">4</button>
                        <button class="hole-btn" onclick="selectHole(5)">5</button>
                        <button class="hole-btn" onclick="selectHole(6)">6</button>
                        <button class="hole-btn" onclick="selectHole(7)">7</button>
                        <button class="hole-btn" onclick="selectHole(8)">8</button>
                        <button class="hole-btn" onclick="selectHole(9)">9</button>
                        <button class="hole-btn" onclick="selectHole(10)">10</button>
                        <button class="hole-btn" onclick="selectHole(11)">11</button>
                        <button class="hole-btn" onclick="selectHole(12)">12</button>
                        <button class="hole-btn" onclick="selectHole(13)">13</button>
                        <button class="hole-btn" onclick="selectHole(14)">14</button>
                        <button class="hole-btn" onclick="selectHole(15)">15</button>
                        <button class="hole-btn" onclick="selectHole(16)">16</button>
                        <button class="hole-btn" onclick="selectHole(17)">17</button>
                        <button class="hole-btn" onclick="selectHole(18)">18</button>
                    </div>
                </div>

                <div class="hole-data-entry" id="holeDataEntry">
                    <div class="hole-title">Hole <span id="currentHole">1</span></div>
                    
                    <div class="stat-group">
                        <h4>Distance Regulation</h4>
                        <div class="toggle-buttons">
                            <button class="toggle-btn" data-stat="100yd" onclick="toggleStat(this)">100yd ‚úì</button>
                            <button class="toggle-btn" data-stat="50yd" onclick="toggleStat(this)">50yd ‚úì</button>
                            <button class="toggle-btn" data-stat="25yd" onclick="toggleStat(this)">25yd ‚úì</button>
                        </div>
                    </div>

                    <div class="stat-group">
                        <h4>Performance</h4>
                        <div class="toggle-buttons">
                            <button class="toggle-btn" data-stat="fairway" onclick="toggleStat(this)">Fairway Hit</button>
                            <button class="toggle-btn" data-stat="green" onclick="toggleStat(this)">Green in Reg</button>
                            <button class="toggle-btn" data-stat="downIn3" onclick="toggleStat(this)">Down in 3</button>
                        </div>
                    </div>

                    <div class="stat-group">
                        <h4>Troubles</h4>
                        <div class="toggle-buttons">
                            <button class="toggle-btn" data-stat="drops" onclick="toggleBadStat(this)">Drops</button>
                            <button class="toggle-btn" data-stat="topped" onclick="toggleBadStat(this)">Topped Ball</button>
                        </div>
                    </div>

                    <div class="stat-group">
                        <h4>Putting & Score</h4>
                        <div class="number-input">
                            <label>Total Putts:</label>
                            <input type="number" id="holePutts" min="0" max="10" value="2">
                        </div>
                        <div class="number-input">
                            <label>Short Putts Missed (4ft):</label>
                            <input type="number" id="holeShortPutts" min="0" max="5" value="0">
                        </div>
                        <div class="number-input">
                            <label>Score:</label>
                            <input type="number" id="holeScore" min="1" max="15" value="4">
                        </div>
                    </div>

                    <button class="btn" onclick="saveHoleData()">Save Hole Data</button>
                    <button class="btn btn-secondary" onclick="clearHoleData()">Clear Hole</button>
                </div>

                <div class="round-summary" id="roundSummary">
                    <h3>Round Summary</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-number" id="totalScore">0</div>
                            <div class="summary-label">Total Score</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="totalPutts">0</div>
                            <div class="summary-label">Total Putts</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="fairwaysHit">0/18</div>
                            <div class="summary-label">Fairways Hit</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="greensHit">0/18</div>
                            <div class="summary-label">Greens in Reg</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="reg100Hit">0/18</div>
                            <div class="summary-label">100yd Reg</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="reg50Hit">0/18</div>
                            <div class="summary-label">50yd Reg</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="reg25Hit">0/18</div>
                            <div class="summary-label">25yd Reg</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="downIn3Hit">0/18</div>
                            <div class="summary-label">Down in 3</div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <p style="text-align: center; margin-top: 10px;">
                        <span id="holesCompleted">0</span>/18 holes completed
                    </p>
                    <button class="btn" onclick="saveRound()" id="saveRoundBtn">Save Round (<span id="holesCompletedBtn">0</span>/18 holes)</button>
                </div>
            </div>
        </div>

        <!-- History -->
        <div id="history" class="tab-content">
            <h2>Round History</h2>
            <div id="historyList">
                <!-- History items will be populated here -->
            </div>
        </div>

        <!-- Trends -->
        <div id="trends" class="tab-content">
            <div class="trends">
                <h2>Progress Trends</h2>
                <div id="trendsList">
                    <!-- Trends will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentRound = {
            holes: {},
            courseName: '',
            date: ''
        };
        let selectedHole = 1;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('roundDate').value = new Date().toISOString().split('T')[0];
            loadHistory();
            loadTrends();
            selectHole(1);
        });

        function selectHole(holeNumber) {
            selectedHole = holeNumber;
            
            // Update UI
            document.querySelectorAll('.hole-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.hole-btn')[holeNumber - 1].classList.add('active');
            
            document.getElementById('currentHole').textContent = holeNumber;
            document.getElementById('holeDataEntry').classList.add('active');
            
            // Load existing data for this hole
            loadHoleData(holeNumber);
        }

        function loadHoleData(holeNumber) {
            const holeData = currentRound.holes[holeNumber] || {};
            
            // Reset all toggles
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active', 'bad');
            });
            
            // Set toggle states
            Object.keys(holeData).forEach(stat => {
                if (stat === 'putts' || stat === 'shortPutts' || stat === 'score') return;
                
                const btn = document.querySelector(`[data-stat="${stat}"]`);
                if (btn) {
                    if (stat === 'drops' && holeData[stat] > 0) {
                        btn.classList.add('bad');
                    } else if (holeData[stat]) {
                        btn.classList.add('active');
                    }
                }
            });
            
            // Set number inputs
            document.getElementById('holePutts').value = holeData.putts || 2;
            document.getElementById('holeShortPutts').value = holeData.shortPutts || 0;
            document.getElementById('holeScore').value = holeData.score || 4;
        }

        function toggleStat(button) {
            button.classList.toggle('active');
        }

        function toggleBadStat(button) {
            button.classList.toggle('bad');
        }

        function saveHoleData() {
            const holeData = {
                '100yd': document.querySelector('[data-stat="100yd"]').classList.contains('active'),
                '50yd': document.querySelector('[data-stat="50yd"]').classList.contains('active'),
                '25yd': document.querySelector('[data-stat="25yd"]').classList.contains('active'),
                fairway: document.querySelector('[data-stat="fairway"]').classList.contains('active'),
                green: document.querySelector('[data-stat="green"]').classList.contains('active'),
                downIn3: document.querySelector('[data-stat="downIn3"]').classList.contains('active'),
                drops: document.querySelector('[data-stat="drops"]').classList.contains('bad') ? 1 : 0,
                topped: document.querySelector('[data-stat="topped"]').classList.contains('bad') ? 1 : 0,
                putts: parseInt(document.getElementById('holePutts').value) || 2,
                shortPutts: parseInt(document.getElementById('holeShortPutts').value) || 0,
                score: parseInt(document.getElementById('holeScore').value) || 4
            };
            
            currentRound.holes[selectedHole] = holeData;
            
            // Mark hole as completed
            document.querySelectorAll('.hole-btn')[selectedHole - 1].classList.add('completed');
            
            // Update summary
            updateRoundSummary();
            
            // Move to next hole if not on 18
            if (selectedHole < 18) {
                selectHole(selectedHole + 1);
            }
        }

        function clearHoleData() {
            delete currentRound.holes[selectedHole];
            document.querySelectorAll('.hole-btn')[selectedHole - 1].classList.remove('completed');
            loadHoleData(selectedHole);
            updateRoundSummary();
        }

        function updateRoundSummary() {
            const holes = Object.values(currentRound.holes);
            const holesCompleted = holes.length;
            
            const totalScore = holes.reduce((sum, hole) => sum + hole.score, 0);
            const totalPutts = holes.reduce((sum, hole) => sum + hole.putts, 0);
            const fairwaysHit = holes.filter(hole => hole.fairway).length;
            const greensHit = holes.filter(hole => hole.green).length;
            const reg100Hit = holes.filter(hole => hole['100yd']).length;
            const reg50Hit = holes.filter(hole => hole['50yd']).length;
            const reg25Hit = holes.filter(hole => hole['25yd']).length;
            const downIn3Hit = holes.filter(hole => hole.downIn3).length;
            
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('totalPutts').textContent = totalPutts;
            document.getElementById('fairwaysHit').textContent = `${fairwaysHit}/18`;
            document.getElementById('greensHit').textContent = `${greensHit}/18`;
            document.getElementById('reg100Hit').textContent = `${reg100Hit}/18`;
            document.getElementById('reg50Hit').textContent = `${reg50Hit}/18`;
            document.getElementById('reg25Hit').textContent = `${reg25Hit}/18`;
            document.getElementById('downIn3Hit').textContent = `${downIn3Hit}/18`;
            document.getElementById('holesCompleted').textContent = holesCompleted;
            document.getElementById('holesCompletedBtn').textContent = holesCompleted;
            document.getElementById('progressFill').style.width = `${(holesCompleted / 18) * 100}%`;
            
            // Always show save button, but change text based on completion
            const saveBtn = document.getElementById('saveRoundBtn');
            if (holesCompleted === 18) {
                saveBtn.textContent = 'Save Complete Round (18/18 holes)';
                saveBtn.style.background = 'linear-gradient(135deg, #2c5f2d, #4a8c4a)';
            } else if (holesCompleted > 0) {
                saveBtn.textContent = `Save Partial Round (${holesCompleted}/18 holes)`;
                saveBtn.style.background = 'linear-gradient(135deg, #6c757d, #5a6268)';
            } else {
                saveBtn.textContent = 'Save Round (0/18 holes)';
                saveBtn.style.background = 'linear-gradient(135deg, #6c757d, #5a6268)';
            }
        }

        function saveRound() {
            const courseName = document.getElementById('courseName').value;
            const roundDate = document.getElementById('roundDate').value;

            if (!courseName || !roundDate) {
                alert('Please fill in course name and date');
                return;
            }

            if (Object.keys(currentRound.holes).length < 18) {
                if (!confirm(`Save partial round with ${Object.keys(currentRound.holes).length} holes completed?`)) {
                    return;
                }
            }

            const holes = Object.values(currentRound.holes);
            const roundData = {
                id: Date.now(),
                courseName,
                date: roundDate,
                holes: currentRound.holes,
                score: holes.reduce((sum, hole) => sum + hole.score, 0),
                putts: holes.reduce((sum, hole) => sum + hole.putts, 0),
                fairways: holes.filter(hole => hole.fairway).length,
                greens: holes.filter(hole => hole.green).length,
                reg100: holes.filter(hole => hole['100yd']).length,
                reg50: holes.filter(hole => hole['50yd']).length,
                reg25: holes.filter(hole => hole['25yd']).length,
                downIn3: holes.filter(hole => hole.downIn3).length,
                drops: holes.reduce((sum, hole) => sum + hole.drops, 0),
                topped: holes.reduce((sum, hole) => sum + hole.topped, 0),
                shortPutts: holes.reduce((sum, hole) => sum + hole.shortPutts, 0),
                timestamp: new Date().toISOString()
            };

            // Save to localStorage
            let rounds = JSON.parse(localStorage.getItem('golfRounds') || '[]');
            rounds.unshift(roundData);
            localStorage.setItem('golfRounds', JSON.stringify(rounds));

            // Reset form
            currentRound = { holes: {} };
            document.getElementById('courseName').value = '';
            document.querySelectorAll('.hole-btn').forEach(btn => {
                btn.classList.remove('completed', 'active');
            });
            document.getElementById('holeDataEntry').classList.remove('active');
            updateRoundSummary();

            alert('Round saved successfully!');
            loadHistory();
            loadTrends();
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab and highlight nav button
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'history') loadHistory();
            if (tabName === 'trends') loadTrends();
        }

        function loadHistory() {
            const rounds = JSON.parse(localStorage.getItem('golfRounds') || '[]');
            const historyList = document.getElementById('historyList');
            
            if (rounds.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No rounds recorded yet</p>';
                return;
            }

            historyList.innerHTML = rounds.map(round => `
                <div class="history-item">
                    <div class="history-header">
                        <span>${round.courseName}</span>
                        <span>${new Date(round.date).toLocaleDateString()}</span>
                    </div>
                    <div class="history-stats">
                        <div class="stat-item">
                            <span>Score:</span>
                            <span>${round.score}</span>
                        </div>
                        <div class="stat-item">
                            <span>Putts:</span>
                            <span>${round.putts}</span>
                        </div>
                        <div class="stat-item">
                            <span>Fairways:</span>
                            <span>${round.fairways}/18</span>
                        </div>
                        <div class="stat-item">
                            <span>Greens:</span>
                            <span>${round.greens}/18</span>
                        </div>
                        <div class="stat-item">
                            <span>Down in 3:</span>
                            <span>${round.downIn3}/18</span>
                        </div>
                        <div class="stat-item">
                            <span>100yd Reg:</span>
                            <span>${round.reg100}/18</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadTrends() {
            const rounds = JSON.parse(localStorage.getItem('golfRounds') || '[]');
            const trendsList = document.getElementById('trendsList');
            
            // Use sample data if no real data exists
            if (rounds.length === 0) {
                // Sample data for demonstration
                const sampleRounds = [
                    { score: 89, putts: 34, fairways: 7, greens: 5, downIn3: 11, reg100: 13, reg50: 9, reg25: 6, drops: 2, topped: 1, shortPutts: 4 },
                    { score: 92, putts: 36, fairways: 6, greens: 4, downIn3: 10, reg100: 12, reg50: 8, reg25: 5, drops: 3, topped: 2, shortPutts: 3 },
                    { score: 87, putts: 32, fairways: 9, greens: 7, downIn3: 13, reg100: 15, reg50: 11, reg25: 8, drops: 1, topped: 0, shortPutts: 6 },
                    { score: 85, putts: 33, fairways: 8, greens: 6, downIn3: 12, reg100: 14, reg50: 10, reg25: 7, drops: 1, topped: 1, shortPutts: 5 },
                    { score: 91, putts: 35, fairways: 5, greens: 3, downIn3: 9, reg100: 11, reg50: 7, reg25: 4, drops: 4, topped: 2, shortPutts: 2 },
                    { score: 83, putts: 31, fairways: 10, greens: 8, downIn3: 14, reg100: 16, reg50: 12, reg25: 9, drops: 0, topped: 0, shortPutts: 7 },
                    { score: 88, putts: 33, fairways: 7, greens: 5, downIn3: 11, reg100: 13, reg50: 9, reg25: 6, drops: 2, topped: 1, shortPutts: 4 },
                    { score: 86, putts: 32, fairways: 8, greens: 6, downIn3: 12, reg100: 14, reg50: 10, reg25: 7, drops: 1, topped: 1, shortPutts: 5 },
                    { score: 94, putts: 37, fairways: 4, greens: 2, downIn3: 8, reg100: 10, reg50: 6, reg25: 3, drops: 5, topped: 3, shortPutts: 1 },
                    { score: 90, putts: 34, fairways: 6, greens: 4, downIn3: 10, reg100: 12, reg50: 8, reg25: 5, drops: 3, topped: 2, shortPutts: 3 }
                ];
                
                displayTrends(sampleRounds, true);
                return;
            }

            displayTrends(rounds, false);
        }

        function displayTrends(rounds, isSample) {
            const trendsList = document.getElementById('trendsList');
            
            // Separate complete rounds (18 holes) from partial rounds for scoring
            const completeRounds = rounds.filter(round => Object.keys(round.holes || {}).length === 18);
            const allRounds = rounds;
            
            // Calculate scoring averages only from complete rounds
            const avgScore = completeRounds.length > 0 ? 
                completeRounds.reduce((sum, round) => sum + round.score, 0) / completeRounds.length : 0;
            const avgPutts = completeRounds.length > 0 ? 
                completeRounds.reduce((sum, round) => sum + round.putts, 0) / completeRounds.length : 0;
            
            // Calculate percentage-based stats from all holes played (including partial rounds)
            let totalHolesPlayed = 0;
            let totalFairways = 0, totalGreens = 0, totalDownIn3 = 0;
            let totalReg100 = 0, totalReg50 = 0, totalReg25 = 0;
            let totalDrops = 0, totalTopped = 0, totalShortPutts = 0;
            
            allRounds.forEach(round => {
                const holesInRound = Object.keys(round.holes || {}).length;
                totalHolesPlayed += holesInRound;
                totalFairways += round.fairways || 0;
                totalGreens += round.greens || 0;
                totalDownIn3 += round.downIn3 || 0;
                totalReg100 += round.reg100 || 0;
                totalReg50 += round.reg50 || 0;
                totalReg25 += round.reg25 || 0;
                totalDrops += round.drops || 0;
                totalTopped += round.topped || 0;
                totalShortPutts += round.shortPutts || 0;
            });

            // Calculate percentages based on total holes played
            const fairwayPct = totalHolesPlayed > 0 ? (totalFairways / totalHolesPlayed * 100) : 0;
            const greenPct = totalHolesPlayed > 0 ? (totalGreens / totalHolesPlayed * 100) : 0;
            const downIn3Pct = totalHolesPlayed > 0 ? (totalDownIn3 / totalHolesPlayed * 100) : 0;
            const reg100Pct = totalHolesPlayed > 0 ? (totalReg100 / totalHolesPlayed * 100) : 0;
            const reg50Pct = totalHolesPlayed > 0 ? (totalReg50 / totalHolesPlayed * 100) : 0;
            const reg25Pct = totalHolesPlayed > 0 ? (totalReg25 / totalHolesPlayed * 100) : 0;
            
            // Calculate per-round averages for troubles
            const avgDropsPerRound = allRounds.length > 0 ? totalDrops / allRounds.length : 0;
            const avgToppedPerRound = allRounds.length > 0 ? totalTopped / allRounds.length : 0;
            const avgShortPuttsPerRound = allRounds.length > 0 ? totalShortPutts / allRounds.length : 0;

            // Calculate improvement (recent vs older - only for complete rounds)
            const recentComplete = completeRounds.slice(0, Math.min(5, completeRounds.length));
            const olderComplete = completeRounds.slice(5, 10);
            
            let scoreImprovement = '';
            let puttsImprovement = '';
            
            if (olderComplete.length > 0 && recentComplete.length > 0) {
                const recentAvgScore = recentComplete.reduce((sum, round) => sum + round.score, 0) / recentComplete.length;
                const olderAvgScore = olderComplete.reduce((sum, round) => sum + round.score, 0) / olderComplete.length;
                const scoreDiff = olderAvgScore - recentAvgScore;
                scoreImprovement = scoreDiff > 0 ? ` ‚ÜóÔ∏è ${scoreDiff.toFixed(1)} better` : ` ‚ÜòÔ∏è ${Math.abs(scoreDiff).toFixed(1)} worse`;

                const recentAvgPutts = recentComplete.reduce((sum, round) => sum + round.putts, 0) / recentComplete.length;
                const olderAvgPutts = olderComplete.reduce((sum, round) => sum + round.putts, 0) / olderComplete.length;
                const puttsDiff = olderAvgPutts - recentAvgPutts;
                puttsImprovement = puttsDiff > 0 ? ` ‚ÜóÔ∏è ${puttsDiff.toFixed(1)} fewer` : ` ‚ÜòÔ∏è ${Math.abs(puttsDiff).toFixed(1)} more`;
            }

            const sampleNote = isSample ? '<p style="text-align: center; color: #999; font-style: italic; margin-bottom: 20px;">üìä Sample data shown - start recording rounds to see your real trends!</p>' : '';
            
            const partialRoundsNote = allRounds.length > completeRounds.length ? 
                `<p style="text-align: center; color: #666; font-size: 14px; margin-bottom: 15px;">üìà Percentages include all ${totalHolesPlayed} holes played. Scoring averages from ${completeRounds.length} complete rounds only.</p>` : '';

            trendsList.innerHTML = `
                ${sampleNote}
                ${partialRoundsNote}
                <div class="trend-item">
                    <span>Average Score</span>
                    <span class="trend-value">${completeRounds.length > 0 ? avgScore.toFixed(1) : 'No complete rounds'}${scoreImprovement}</span>
                </div>
                <div class="trend-item">
                    <span>Average Putts</span>
                    <span class="trend-value">${completeRounds.length > 0 ? avgPutts.toFixed(1) : 'No complete rounds'}${puttsImprovement}</span>
                </div>
                <div class="trend-item">
                    <span>Fairways Hit</span>
                    <span class="trend-value">${totalFairways}/${totalHolesPlayed} (${fairwayPct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>Greens in Regulation</span>
                    <span class="trend-value">${totalGreens}/${totalHolesPlayed} (${greenPct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>Down in 3</span>
                    <span class="trend-value">${totalDownIn3}/${totalHolesPlayed} (${downIn3Pct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>100yd Regulation</span>
                    <span class="trend-value">${totalReg100}/${totalHolesPlayed} (${reg100Pct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>50yd Regulation</span>
                    <span class="trend-value">${totalReg50}/${totalHolesPlayed} (${reg50Pct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>25yd Regulation</span>
                    <span class="trend-value">${totalReg25}/${totalHolesPlayed} (${reg25Pct.toFixed(0)}%)</span>
                </div>
                <div class="trend-item">
                    <span>Short Putts Missed (4ft)</span>
                    <span class="trend-value">${avgShortPuttsPerRound.toFixed(1)} per round</span>
                </div>
                <div class="trend-item">
                    <span>Average Drops</span>
                    <span class="trend-value">${avgDropsPerRound.toFixed(1)} per round</span>
                </div>
                <div class="trend-item">
                    <span>Average Topped Balls</span>
                    <span class="trend-value">${avgToppedPerRound.toFixed(1)} per round</span>
                </div>
                <div class="trend-item">
                    <span>Best Score</span>
                    <span class="trend-value">${completeRounds.length > 0 ? Math.min(...completeRounds.map(r => r.score)) : 'No complete rounds'}</span>
                </div>
                <div class="trend-item">
                    <span>Worst Score</span>
                    <span class="trend-value">${completeRounds.length > 0 ? Math.max(...completeRounds.map(r => r.score)) : 'No complete rounds'}</span>
                </div>
                <div class="trend-item">
                    <span>Total Holes Played</span>
                    <span class="trend-value">${totalHolesPlayed} (${allRounds.length} rounds)</span>
                </div>
            `;
        }
    </script>
</body>
</html>
